<workunit schemaName="vw_building_application" 
          processName="building_application" 
          entitySchemaName="building_application"
          allowCreate="false">
    <invokers>
        <invoker type="vw_building_application:open" caption="Building Permit Application" action="open" index="1"/>

        <!-- open from evaluation -->
        <invoker type="vw_building_evaluation:form:extActions" target="popup" 
                 caption="View Application" action="openFromCaller" index="1"/>
        
        <!-- assessment actions -->        
        <invoker type="feeActions" 
                caption="Assess"
                action="assess" 
                index="1"
                visibleWhen="#{task.state == 'assessment' &amp;&amp; task.assignee.objid == userInfo.userid }"    />
                
        <invoker type="feeActions" 
                caption="Add Fee"
                action="addFee" 
                index="1"
                visibleWhen="#{task.state == 'assessment' &amp;&amp; task.assignee.objid == userInfo.userid }"    />        

        <invoker type="feeActions" 
                caption="Clear Fees"
                action="clearFees" 
                index="1"
                visibleWhen="#{task.state == 'assessment' &amp;&amp; task.assignee.objid == userInfo.userid }"    />

        <invoker type="feeActions" 
                caption="Preview"
                action="previewFees" 
                index="2"
                visibleWhen="#{task.state == 'assessment' &amp;&amp; task.assignee.objid == userInfo.userid }"    />
       
                    
        <invoker type="appActions" 
                caption="Change Occupancy Type"
                action="changeOccupancyType" 
                visibleWhen="#{task.state.matches('verification|assessment') 
                    &amp;&amp; task.assignee.objid == userInfo.userid }"   />
                    
        <invoker type="appActions" 
                caption="Issue Permit"
                action="issuePermit" 
                visibleWhen="#{task.state == 'releasing'
                    &amp;&amp; entity.permitid == null                   
                    &amp;&amp; task.assignee.objid == userInfo.userid }"   />            
                    
                    
        <invoker type="appActions" 
                caption="Edit"
                action="edit" 
                index="-2" />   
        
    </invokers>
    <code class="com.rameses.gov.etracs.obo.building.models.BuildingApplicationModel" />
    <pages>
        <page template="com.rameses.gov.etracs.obo.building.views.BuildingApplicationPage" />
        <page name="edit" template="com.rameses.gov.etracs.obo.building.views.BuildingApplicationEditPage" />        
    </pages>
</workunit>