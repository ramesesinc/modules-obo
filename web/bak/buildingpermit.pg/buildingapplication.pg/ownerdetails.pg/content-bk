<%if( PARAMS.error !=null) { %>
<pre>Error ${PARAMS.error?.message}</pre>
<% } %>

<script>
\$put("${PAGE.context}", 
   new function() {
      var svc = Service.lookup("CacheService", "default");
      var self = this;

      this.application = {items: []};
      this.entity = {};
      this.prcno;
      this.professional;

      this.onload = function() {
        var val = svc.get( "${PARAMS.ctcno}_bldgapp" );
        if (val != null) {
          self.entity = val.entity;
          self.application = self.application;
        }
        if (!self.entity) self.entity = {};
        if (!self.application) self.application = {};
      }

      this.submit = function() {

        var prm = {
          key: "${PARAMS.ctcno}_bldgapp",
          value: {
            entity: self.entity,
            application: self.application
          }
        }

        //window.console.log( prm );
        svc.put( prm );

        var elem = \$("#form1");
        if (elem != null) {
          elem.attr("action", "/partners/${PARAMS.name}/services/buildingpermit/buildingapplication/preapplication");
          elem.submit();
        }
      }

      this.confirmProfessional = function() {
        self.entity.professional = self.professional;
        self.professional = null;
        self.prcno = null;
        \$("#professional-result").addClass("hide");
      }

      this.searchProfessional = function() {
        var elem = \$("#professional-result");
        elem.addClass("hide");
        if (!self.prcno) return;
        self.professional = null;

        var professions = svc.get( "professions" );
        for (var i=0; i<professions.length; i++) {
          var x = professions[i];
          if (self.prcno == x.prcno) {
            if (!x.name) {
              x.name = x.lastname + ", " + x.firstname;
              if (x.middlename) x.name += " " + x.middlename;
            }
            self.professional = x;
            break;
          }
        }

        elem.removeClass("hide");

      }
   }
);  

  \$(document).ready(function() {
    \$('.group_ctrl').change(function () {
        \$("." + \$(this).data("group")).prop('disabled', !this.checked);
    }).change();
});

</script>

<style>
  .hide{
    display: none;
  }
</style>

<div id="content">
  <div class="container">
    <div class="home" style="margin-bottom:200px;">
      <h1>Application for New Building Permit</h1>
      <br>
      <div class="row">
        <div class="col-md-12">

          <div class="col-md-2">
            <p class="font16">Tax Dec. No</p>
            <p class="font16">TCT No.</p>
            <p class="font16">Lot No.</p>
            <p class="font16">Address:</p>
          </div>
          <div class="col-md-6">
            <p class="font16" >: <label class="font16"  r:context="app">345</label></p>
            <p class="font16" >: <label class="font16"  r:context="app">39081</label></p>
            <p class="font16" >: <label class="font16"  r:context="app">39081</label></p>
            <p class="font16" >: <label class="font16"  r:context="app">14567 Purok Centro 2, Poblacion, Legazpi City</label></p>
          </div>
        </div>
        <br>
        <div class="col-md-12" id="app-content"></div>
      </div>
      <hr>
      <div class="row">
        <div class="col-md-12">
            <h3> Project Details</h3>
            <br>
            <div class="row">
              <div class="col-md-5">
                  <div class="control-group">
                     <input type="text" r:name="entity.project" r:context="${PAGE.context}" class="form-control" placeholder="Specify">
                  </div>
              </div>
            </div>
           <hr>
          <h3>Scope of Work</h3>
          <br>
              <div class="row">
                  <div class="col-md-6">
                      <label class="labelInput">
                        <input type='checkbox' class="group_ctrl" value="New Construction"> New Construction
                      </label>
                      <label class="labelInput">
                        <input type='checkbox' class="group_ctrl" value="Erection"> Erection
                      </label>
                      <label class="labelInput">
                        <input type='checkbox' class="group_ctrl" value="Addition"> Addition
                      </label>
                      <label class="labelInput">
                        <input type='checkbox' class="group_ctrl" value="Alteration"> Alteration
                      </label>
                      <label class="labelInput">
                        <input type='checkbox' class="group_ctrl" value="Renovation"> Renovation
                      </label>
                      <label class="labelInput">
                        <input type='checkbox' class="group_ctrl" value="Repair"> Conversion
                      </label>
                  </div>
                  <div class="col-md-6">
                        <label class="labelInput">
                          <input type='checkbox' class="group_ctrl" value="Repair"> Repair
                        </label>
                        <label class="labelInput">
                          <input type='checkbox' class="group_ctrl" value="Moving"> Moving
                        </label>
                         <label class="labelInput">
                          <input type='checkbox' class="group_ctrl" value="Raising"> Raising
                        </label>
                        <label class="labelInput">
                          <input type='checkbox' class="group_ctrl" value="Accessory Building/Structure"> Accessory Building/Structure
                        </label>
                      <div class="row">
                        <div class="col-md-6  col-xs-6">
                          <label class="labelInput">
                          <input type='checkbox' class="group_ctrl" data-group="group_k" value="Others" r:context="${PAGE.context}"> Others
                        </label>
                        </div>

                        <div class="col-md-6  col-xs-6">
                          <input type="text" class="group_k form-control" r:context="${PAGE.context}">
                        </div>
                      </div>
                  </div>
              </div>  
          <hr>
          <h3>Use or Character of Occupancy</h3>
          <br>
          <div class="row">
              <div class="col-md-5">
                  <select class="form-control" r:context="${PAGE.context}" r:name="entity.occupancy">
                    <option value="" selected="selected" disabled>Select</option>
                    <option value="GROUP A: Residential, Dwellings">GROUP A: Residential, Dwellings</option>
                    <option value="GROUP B: Residential Hotel, Apartment">GROUP B: Residential Hotel, Apartment</option>
                    <option value="GROUP C: Educational, Recreational">GROUP C: Educational, Recreational</option>
                    <option value="GROUP D: Institutional">GROUP D: Institutional</option>
                    <option value="GROUP E: Business and Mercantile">GROUP E: Business and Mercantile</option>
                    <option value="GROUP F: Industrial">GROUP F: Industrial</option>
                    <option value="GROUP G: Industrial Storage and Hazardous">GROUP G: Industrial Storage and Hazardous</option>
                    <option value="GROUP H: Recreational, Assembly occupant load less than 1000">GROUP H: Recreational, Assembly occupant load less than 1000</option>
                    <option value="GROUP I: Recreational, Assembly occupant load 1000 or more">GROUP I: Recreational, Assembly occupant load 1000 or more</option>
                    <option value="GROUP J: Agricultural, Accessory">GROUP J: Agricultural, Accessory</option>
                    <option value="others">Others</option>
                  </select>
              </div>
              <div class="col-md-6">
                  <div class="control-group">
                     <input type="text" r:context="${PAGE.context}" r:depends="entity.occupancy" r:name="entity.others" r:visibleWhen="#{entity.occupancy=='others'}" r:depends="entity.occupancy" style="display:none"class="form-control" placeholder="Specify">
                  </div>
              </div>
          </div>
      <hr>
      <div class="row">
          <div class="col-md-5">
              <div class="control-group">
                <label class="control-label" >Occupancy Classified</label>
                  <input type="text" r:name="entity.classified" r:context="${PAGE.context}" placeholder="" class="form-control">
              </div>
          </div>
          <div class="col-md-5">
              <div class="control-group">
                <label class="control-label" >Total Estimated Cost P</label>
                  <input type="text" placeholder="" r:name="entity.totalestimated" r:context="${PAGE.context}" class="form-control">
              </div>
          </div>
      </div>
      <div class="row">
         <br>
         <div class="col-md-5">
          <div class="control-group">
            <label class="control-label">Number of Units</label>
              <input type="text" r:context="${PAGE.context}" r:name="entity.units" r:datatype="integer" placeholder="" value="1" class="form-control" style="width:60px">
          </div>
          <br>
         </div>
         <div class="col-md-5">
            <div class="control-group">
              <label class="control-label">Proposed Date of Construction</label>
               <input type="text"  r:datatype="date" r:context="${PAGE.context}" r:name="application.proposedate"  class="form-control" placeholder="Choose Date">
            </div>
         </div>
      </div>
      <div class="row">
         <div class="col-md-5">
          <div class="control-group">
            <label class="control-label">Total Floor Area</label>
              <input type="text" placeholder="Square Meters" r:name="entity.totalfloor" r:context="${PAGE.context}" class="form-control">
          </div>
        </div>
        <div class="col-md-5">
          <div class="control-group">
            <label class="control-label">Expected Date of Completion</label>
              <input type="text"  r:datatype="date" r:context="${PAGE.context}" r:name="application.expecteddate" class="form-control" placeholder="Choose Date">
          </div>
        </div>
        <br> 
      </div>
          <!--
          <br/>
          <div class="row">
            <div class="col-md-8">
              <h3>Architect</h3>
              <p class="font16">PRC No. : <label class="font16" r:context="${PAGE.context}" r:name="entity.professional.prcno" /></p>
              <p class="font16">Professional : <label class="font16" r:context="${PAGE.context}" r:name="entity.professional.name" /></p>
            </div>
          </div>
          <br>
          <div class="row">
            <div class="col-md-8">
              <div class="input-group">
                <input type="text" r:context="${PAGE.context}" r:name="prcno" placeholder="Search Architect by PRC No." class="form-control" required/>
                <span class="input-group-btn">
                  <input type="submit" value="Search" class="btn btn-submit btn-primary" r:context="${PAGE.context}" r:name="searchProfessional" />
                </span>
              </div>
            </div>
          </div> 
          <div id="professional-result" class="row hide">
            <br/>
            <div class="col-md-8">
              <h3>Result</h3>
              <div class="control-group">
                <p class="font16">PRC No. : <label class="font16" r:context="${PAGE.context}" r:name="professional.prcno" /></p>
                <p class="font16">Professional : <label class="font16" r:context="${PAGE.context}" r:name="professional.name" /></p>
                <span class="input-group-btn">
                  <input type="submit" value="Confirm" class="btn btn-submit btn-primary" r:context="${PAGE.context}" r:name="confirmProfessional" />
                </span>
              </div>
            </div>
          </div>
          
          <form method="post" action="/partners/${PARAMS.name}/services/buildingpermit/buildingapplication/preapplication"> -->
          <br>

          <h3>Full-time Inspector and Supervisor of Construction Works (REPRESENTING THE OWNER)</h3>
          <br>
          @box2()
          <div class="row" style="margin-top:30px;">
            <form method="post" id="form1">
                <div class="col-md-1">
                  <input type="hidden" name="ctcno" value="${PARAMS.ctcno}" />
                  <!-- <input class="thumbnail btn btn-primary" type="submit" value="Next"> -->
                  <input class="thumbnail btn btn-primary" type="submit" value="Next" r:context="${PAGE.context}" r:name="submit" >
                </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>





